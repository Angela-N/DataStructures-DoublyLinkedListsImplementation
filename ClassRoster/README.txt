I used the second implementation from the book.